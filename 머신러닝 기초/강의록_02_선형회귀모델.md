## 선형회귀 모델
[목차 1][#1.-개요]

###1. 개요
- x, y 변수 사이의 관계
    - 확정적 관계 : x변수만으로 y변수를 100% 설명
        - ![수식](https://latex.codecogs.com/gif.latex?Y%20%3D%20f%28x%29)
    - 확률적 관계 : x변수와 오차항이 y를 설명
        - ![수식](https://latex.codecogs.com/gif.latex?Y%20%3D%20f%28x%29%20&plus;%20%5Cvarepsilon)

- 선형회귀모델 : 반응변수(Y)를 예측변수(X)들의 선형결합으로 표현한 모델(x, y 사이의 관계를 **수치로 설명** 및 **미래(y)를 예측**)
- 회귀모델의 종류   
![캡처](https://user-images.githubusercontent.com/43491168/109406634-089a2900-79be-11eb-992e-686440967551.PNG)

- 선형회귀모델 가정 :    
![캡처](https://user-images.githubusercontent.com/43491168/109406817-6aa75e00-79bf-11eb-8e82-7f8109e3e49d.PNG)
    - 확률오차 가정 : 
        - ![수식](https://latex.codecogs.com/gif.latex?%5Cvarepsilon_%7Bi%7D%20%5Csim%20N%28o%2C%20%5Csigma%20%5E%7B2%7D%29%2C%20i%20%3D%201%2C2%2C...%2Cn) 
        - ![수식](https://latex.codecogs.com/gif.latex?Y_%7Bi%7D%20%3D%20%5Cbeta%20_%7B0%7D%20&plus;%20%5Cbeta%20_%7B1%7Dx_%7Bi%7D%20&plus;%20%5Cvarepsilon) : 오차항이 확률분포 이므로 Yi도 확률분포를 가진다(즉, Yi는 확률변수이다.)
<!--이하 필기 대체-->
![필기](https://user-images.githubusercontent.com/43491168/109407365-8dd40c80-79c3-11eb-8037-538d75883c88.png)

### 2. 파라미터 추정
![캡처](https://user-images.githubusercontent.com/43491168/109409119-3d64ab00-79d3-11eb-83b8-f35fec2292ae.PNG)

- 비용함수의 형태
    - Cost function is convex -> globally optimal solution exists(전역 최적해[global minimum] <-> 지역 최적해[local minimum])
    - ![비용함수 캡처 추가](https://user-images.githubusercontent.com/43491168/109411393-2038d800-79e5-11eb-97e6-26cfec47039a.PNG)

- 비용함수 추정 알고리즘(최소제곱법, Least Squared Method)
    - ![추정 과정 정리 캡쳐](https://user-images.githubusercontent.com/43491168/109411182-90465e80-79e3-11eb-8b89-a258f273cde8.PNG)

- 잔차(Residual) 와 확률오차(Random Error)차이
    - 잔차 e(Residual, 정해진 값)는 확률오차 Epsilon(Random Error)이 실제로 구현된 값

#### 실습

```python
# 최소제곱법 활용 단순선형회귀 구현
# x : 집크기 / y : 집가격
x = [1380, 3120, 3520, 1130, 1030, 1720, 3920, 1490, 1860, 3430, 2000, 3660, 2500, 1220, 1390]
y = [76, 216, 238, 69, 50, 119, 282, 81, 132, 228, 145, 251, 170, 71, 29]

# x, y mean
x_mean = sum(x)/len(x)
y_mean = sum(y)/len(y)

# beta 1
beta1_hat = sum(list(map(lambda x1, y1 : (x1 - x_mean)*(y1 - y_mean) , x, y))) / sum(list(map(lambda x1 : (x1 - x_mean)**2 , x)))
# beta 0
beta0_hat = y_mean - beta1_hat*x_mean

# 결과 출력
print("Y = ", round(beta0_hat, 1), " + ", round(beta1_hat, 4), "X")
#Y =  -29.6  +  0.0779 X
```
